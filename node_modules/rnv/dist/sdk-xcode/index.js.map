{"version":3,"sources":["../../src/sdk-xcode/index.js"],"names":["generateChecksum","str","algorithm","encoding","crypto","createHash","update","digest","checkIfPodsIsRequired","c","appFolder","platform","podChecksumPath","path","join","podChecksum","toString","podContentChecksum","updatePodsChecksum","existingContent","runCocoaPods","program","updatePods","Promise","reject","podsRequired","Error","cwd","env","process","s","isGenericError","includes","then","catch","er","copyAppleAssets","appFolderName","resolve","runXcodeProject","runtime","target","appPath","device","scheme","runScheme","bundleIsDev","bundleAssets","yellow","white","paths","appConfig","config","grey","devicesArr","length","name","udid","p","targetUDID","run","selectedDevice","JSON","stringify","packageBundleForXcode","_checkLockAndExec","find","d","devices","map","v","icon","green","version","isDevice","red","value","inquirer","prompt","message","type","choices","sim","replace","cmd","isDeviceLocked","isDeviceNotRegistered","confirm","isDevelopmentTeamMissing","loc","appId","_setDevelopmentTeam","isAutomaticSigningDisabled","_handleProvisioningIssues","isProvisioningMissing","e","msg","provisioningStyle","isProvAutomatic","proAutoText","fixCommand","workspacePath","confirmAuto","_setAutomaticSigning","files","platforms","buildSchemes","teamID","plat","composeXcodeArgsFromCLI","string","spacesReplaced","keysAndValues","split","unescapedValues","buildXcodeProject","getAppFolderName","destinationPlatform","TVOS","IOS","buildPath","allowProvisioningUpdates","ignoreLogs","ps","xcodebuildArgs","push","buildConfig","cyan","args","rawCommand","archiveXcodeProject","sdk","MACOS","sdkArr","exportPath","exportPathArchive","xcodebuildArchiveArgs","exportXcodeProject","xcodebuildExportArgs","isDev","entryFile","info","projectFolder","runAppleLog","filter","child","child_process","execFile","stdio","customFds","stdout","on","data","toLowerCase","configureXcodeProject","bundlerIp","platformBuildsProjectPath","pluginConfigiOS","podfileInject","staticFrameworks","staticPodDefinition","exportOptions","embeddedFonts","embeddedFontSources","ignoreProjectFonts","pluginAppDelegateImports","pluginAppDelegateMethods","appDelegateMethods","application","didFinishLaunchingWithOptions","applicationDidBecomeActive","open","supportedInterfaceOrientationsFor","didReceiveRemoteNotification","didFailToRegisterForRemoteNotificationsWithError","didReceive","didRegister","didRegisterForRemoteNotificationsWithDeviceToken","continue","userNotificationCenter","willPresent","podfileSources","embeddedFontSourcesCheck","font","dir","key","includedFonts","fontSource","fontFolder","fontDest","tId"],"mappings":"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","sourcesContent":["/* eslint-disable import/no-cycle */\n// @todo fix circular dep\nimport path from 'path';\nimport child_process from 'child_process';\nimport inquirer from 'inquirer';\nimport crypto from 'crypto';\nimport {\n    fsExistsSync,\n    copyFileSync,\n    mkdirSync,\n    writeFileSync,\n    fsWriteFileSync,\n    fsReadFileSync\n} from '../core/systemManager/fileutils';\nimport { executeAsync, commandExistsSync } from '../core/systemManager/exec';\nimport { getAppleDevices } from './deviceManager';\nimport { registerDevice } from './fastlane';\nimport {\n    getAppFolder,\n    getConfigProp,\n    getIP,\n} from '../core/common';\nimport { generateEnvVars } from '../core/engineManager';\nimport { doResolve } from '../core/resolve';\nimport { isPlatformActive } from '../core/platformManager';\nimport {\n    copyAssetsFolder,\n    copyBuildsFolder,\n    parseFonts\n} from '../core/projectManager/projectParser';\n\nimport { IOS, TVOS, MACOS } from '../core/constants';\nimport {\n    parseExportOptionsPlist,\n    parseInfoPlist,\n    parseEntitlementsPlist\n} from './plistParser';\nimport { parseXcscheme } from './xcschemeParser';\nimport { parsePodFile } from './podfileParser';\nimport { parseXcodeProject } from './xcodeParser';\nimport { parseAppDelegate } from './swiftParser';\nimport {\n    chalk,\n    logInfo,\n    logTask,\n    logError,\n    logWarning,\n    logDebug,\n    logSuccess,\n    logRaw\n} from '../core/systemManager/logger';\n\nexport const generateChecksum = (str, algorithm, encoding) => crypto\n    .createHash(algorithm || 'md5')\n    .update(str, 'utf8')\n    .digest(encoding || 'hex');\n\nconst checkIfPodsIsRequired = async (c) => {\n    const appFolder = getAppFolder(c, c.platform);\n    const podChecksumPath = path.join(appFolder, 'Podfile.checksum');\n    if (!fsExistsSync(podChecksumPath)) return true;\n    const podChecksum = fsReadFileSync(podChecksumPath).toString();\n    const podContentChecksum = generateChecksum(\n        fsReadFileSync(path.join(appFolder, 'Podfile')).toString()\n    );\n\n    if (podChecksum !== podContentChecksum) {\n        logDebug('runCocoaPods:isMandatory');\n        return true;\n    }\n    logInfo(\n        'Pods do not seem like they need to be updated. If you want to update them manually run the same command with \"-u\" parameter'\n    );\n    return false;\n};\n\nconst updatePodsChecksum = (c) => {\n    logTask('updatePodsChecksum');\n    const appFolder = getAppFolder(c, c.platform);\n    const podChecksumPath = path.join(appFolder, 'Podfile.checksum');\n    const podContentChecksum = generateChecksum(\n        fsReadFileSync(path.join(appFolder, 'Podfile')).toString()\n    );\n    if (fsExistsSync(podChecksumPath)) {\n        const existingContent = fsReadFileSync(podChecksumPath).toString();\n        if (existingContent !== podContentChecksum) {\n            logDebug(`updatePodsChecksum:${podContentChecksum}`);\n            return fsWriteFileSync(podChecksumPath, podContentChecksum);\n        }\n        return true;\n    }\n    logDebug(`updatePodsChecksum:${podContentChecksum}`);\n    return fsWriteFileSync(podChecksumPath, podContentChecksum);\n};\n\nconst runCocoaPods = async (c) => {\n    logTask('runCocoaPods', `forceUpdate:${!!c.program.updatePods}`);\n\n    const appFolder = getAppFolder(c);\n\n    if (!fsExistsSync(appFolder)) {\n        return Promise.reject(`Location ${appFolder} does not exists!`);\n    }\n    const podsRequired = c.program.updatePods || (await checkIfPodsIsRequired(c));\n\n    if (podsRequired) {\n        if (!commandExistsSync('pod')) {\n            throw new Error(\n                'Cocoapods not installed. Please run `sudo gem install cocoapods`'\n            );\n        }\n\n        try {\n            await executeAsync(c, 'pod install', {\n                cwd: appFolder,\n                env: process.env\n            });\n        } catch (e) {\n            const s = e?.toString ? e.toString() : '';\n            const isGenericError = s.includes('No provisionProfileSpecifier configured')\n                || s.includes('TypeError:')\n                || s.includes('ReferenceError:')\n                || s.includes('find gem cocoapods');\n            if (isGenericError) { return new Error(`pod install failed with:\\n ${s}`); }\n            logWarning(\n                `pod install is not enough! Let's try pod update! Error:\\n ${s}`\n            );\n            return executeAsync(c, 'pod update', {\n                cwd: appFolder,\n                env: process.env\n            })\n                .then(() => updatePodsChecksum(c))\n                .catch(er => Promise.reject(er));\n        }\n\n        updatePodsChecksum(c);\n        return true;\n    }\n};\n\nconst copyAppleAssets = (c, platform, appFolderName) => new Promise((resolve) => {\n    logTask('copyAppleAssets');\n    if (!isPlatformActive(c, platform, resolve)) return;\n\n    const appFolder = getAppFolder(c);\n\n    // ASSETS\n    fsWriteFileSync(path.join(appFolder, 'main.jsbundle'), '{}');\n    mkdirSync(path.join(appFolder, 'assets'));\n    mkdirSync(path.join(appFolder, `${appFolderName}/images`));\n\n    resolve();\n});\n\nexport const runXcodeProject = async (c) => {\n    logTask('runXcodeProject', `target:${c.runtime.target}`);\n\n    const appPath = getAppFolder(c, c.platform);\n    const { device } = c.program;\n    const scheme = getConfigProp(c, c.platform, 'scheme');\n    const runScheme = getConfigProp(c, c.platform, 'runScheme');\n    const bundleIsDev = getConfigProp(c, c.platform, 'bundleIsDev') === true;\n    const bundleAssets = getConfigProp(c, c.platform, 'bundleAssets') === true;\n    let p;\n\n    if (!scheme) {\n        return Promise.reject(\n            `Missing scheme in platforms.${chalk().yellow(\n                c.platform\n            )} in your ${chalk().white(\n                c.paths.appConfig.config\n            )}! Check example config for more info:  ${chalk().grey(\n                'https://github.com/pavjacko/renative/blob/master/appConfigs/helloworld/renative.json'\n            )} `\n        );\n    }\n\n    let devicesArr;\n    if (device === true) {\n        devicesArr = await getAppleDevices(c, false, true);\n    } else if (c.runtime.target === true) {\n        devicesArr = await getAppleDevices(c, true, false);\n    }\n\n    if (device === true) {\n        if (devicesArr.length === 1) {\n            logSuccess(\n                `Found one device connected! device name: ${chalk().white(\n                    devicesArr[0].name\n                )} udid: ${chalk().white(devicesArr[0].udid)}`\n            );\n            if (devicesArr[0].udid) {\n                p = `--device --udid ${devicesArr[0].udid}`;\n                c.runtime.targetUDID = devicesArr[0].udid;\n            } else {\n                p = `--device ${devicesArr[0].name}`;\n            }\n        } else if (devicesArr.length > 1) {\n            const run = (selectedDevice) => {\n                logDebug(\n                    `Selected device: ${JSON.stringify(\n                        selectedDevice,\n                        null,\n                        3\n                    )}`\n                );\n                c.runtime.targetUDID = selectedDevice.udid;\n                if (selectedDevice.udid) {\n                    p = `--device --udid ${selectedDevice.udid}`;\n                } else {\n                    p = `--device ${selectedDevice.name}`;\n                }\n\n                logDebug(`RN params: ${p}`);\n\n                if (bundleAssets) {\n                    logDebug('Assets will be bundled');\n                    return packageBundleForXcode(\n                        c,\n                        bundleIsDev\n                    ).then(() => _checkLockAndExec(c, appPath, scheme, runScheme, p));\n                }\n                return _checkLockAndExec(c, appPath, scheme, runScheme, p);\n            };\n\n            if (c.runtime.target !== true) {\n                const selectedDevice = devicesArr.find(\n                    d => d.name === c.runtime.target\n                );\n                if (selectedDevice) {\n                    return run(selectedDevice);\n                }\n                logWarning(`Could not find device ${c.runtime.target}`);\n            }\n\n            const devices = devicesArr.map(v => ({\n                name: `${v.name} | ${v.icon} | v: ${chalk().green(\n                    v.version\n                )} | udid: ${chalk().grey(v.udid)}${\n                    v.isDevice ? chalk().red(' (device)') : ''\n                }`,\n                value: v\n            }));\n\n            const { sim } = await inquirer.prompt({\n                name: 'sim',\n                message: 'Select the device you want to launch on',\n                type: 'list',\n                choices: devices\n            });\n\n            if (sim) {\n                return run(sim);\n            }\n        } else {\n            return Promise.reject(`No ${c.platform} devices connected!`);\n        }\n    } else if (device) {\n        p = `--device ${device}`;\n    } else if (c.runtime.target === true) {\n        const devices = devicesArr.map(v => ({\n            name: `${v.name} | ${v.icon} | v: ${chalk().green(\n                v.version\n            )} | udid: ${chalk().grey(v.udid)}${\n                v.isDevice ? chalk().red(' (device)') : ''\n            }`,\n            value: v\n        }));\n\n        const { sim } = await inquirer.prompt({\n            name: 'sim',\n            message: 'Select the device you want to launch on',\n            type: 'list',\n            choices: devices\n        });\n        c.runtime.target = sim.name;\n        p = `--simulator ${c.runtime.target.replace(/(\\s+)/g, '\\\\$1')}`;\n    } else {\n        p = `--simulator ${c.runtime.target.replace(/(\\s+)/g, '\\\\$1')}`;\n    }\n\n    if (p) {\n        // const allowProvisioningUpdates = getConfigProp(\n        //     c,\n        //     c.platform,\n        //     'allowProvisioningUpdates',\n        //     true\n        // );\n        // if (allowProvisioningUpdates) p.push('--allowProvisioningUpdates');\n\n        if (bundleAssets) {\n            return packageBundleForXcode(c, bundleIsDev)\n                .then(() => _checkLockAndExec(c, appPath, scheme, runScheme, p));\n        }\n        return _checkLockAndExec(c, appPath, scheme, runScheme, p);\n    }\n    return Promise.reject('Missing options for react-native command!');\n};\n\nconst _checkLockAndExec = async (c, appPath, scheme, runScheme, p) => {\n    logTask('_checkLockAndExec', `scheme:${scheme} runScheme:${runScheme}`);\n    const cmd = `node ${doResolve(\n        'react-native'\n    )}/local-cli/cli.js run-ios --project-path ${appPath} --scheme ${scheme} --configuration ${runScheme} ${p}`;\n    try {\n        // Inherit full logs\n        // return executeAsync(c, cmd, { stdio: 'inherit', silent: true });\n        return executeAsync(c, cmd);\n    } catch (e) {\n        if (e && e.includes) {\n            const isDeviceLocked = e.includes('ERROR:DEVICE_LOCKED');\n            if (isDeviceLocked) {\n                await inquirer.prompt({\n                    message: 'Unlock your device and press ENTER',\n                    type: 'confirm',\n                    name: 'confirm'\n                });\n                return executeAsync(c, cmd);\n            }\n            const isDeviceNotRegistered = e.includes(\n                \"doesn't include the currently selected device\"\n            );\n            if (isDeviceNotRegistered) {\n                logError(e);\n                logWarning(\n                    `${c.platform} DEVICE: ${chalk().white(\n                        c.runtime.target\n                    )} with UDID: ${chalk().white(\n                        c.runtime.targetUDID\n                    )} is not included in your provisionong profile in TEAM: ${chalk().white(\n                        getConfigProp(c, c.platform, 'teamID')\n                    )}`\n                );\n                const { confirm } = await inquirer.prompt({\n                    name: 'confirm',\n                    message: 'Do you want to register it?',\n                    type: 'confirm'\n                });\n                if (confirm) {\n                    await registerDevice(c);\n                    return Promise.reject('Updated. Re-run your last command');\n                    // TODO: Tot picking up if re-run from here. forcing users to do it themselves for now\n                    // await configureXcodeProject(c, c.platform);\n                    // return runXcodeProject(c);\n                }\n            }\n            const isDevelopmentTeamMissing = e.includes(\n                'requires a development team. Select a development team'\n            );\n            if (isDevelopmentTeamMissing) {\n                const loc = `./appConfigs/${\n                    c.runtime.appId\n                }/renative.json:{ \"platforms\": { \"${c.platform}\": { \"teamID\": \".....\"`;\n                logError(e);\n                logWarning(`You need specify the development team if you want to run app on ${\n                    c.platform\n                } device. this can be set manually in ${chalk().white(loc)}\n  You can find correct teamID in the URL of your apple developer account: ${chalk().white(\n        'https://developer.apple.com/account/#/overview/YOUR-TEAM-ID'\n    )}`);\n                const { confirm } = await inquirer.prompt({\n                    name: 'confirm',\n                    message: `Type in your Apple Team ID to be used (will be saved to ${c.paths.appConfig?.config})`,\n                    type: 'input'\n                });\n                if (confirm) {\n                    await _setDevelopmentTeam(c, confirm);\n                    return Promise.reject('Updated. Re-run your last command');\n                    // TODO: Tot picking up if re-run from here. forcing users to do it themselves for now\n                    // await configureXcodeProject(c, c.platform);\n                    // return runXcodeProject(c);\n                }\n            }\n            const isAutomaticSigningDisabled = e.includes(\n                'Automatic signing is disabled and unable to generate a profile'\n            );\n            if (isAutomaticSigningDisabled) {\n                return _handleProvisioningIssues(\n                    c,\n                    e,\n                    \"Your iOS App Development provisioning profiles don't match. under manual signing mode\"\n                );\n            }\n            const isProvisioningMissing = e.includes(\n                'requires a provisioning profile'\n            );\n            if (isProvisioningMissing) {\n                return _handleProvisioningIssues(\n                    c,\n                    e,\n                    'Your iOS App requires a provisioning profile'\n                );\n            }\n        }\n\n        return Promise.reject(`${e}\n\n${chalk().green('SUGGESTION:')}\n\n${chalk().yellow('STEP 1:')}\nOpen xcode workspace at: ${chalk().white(`${appPath}/RNVApp.xcworkspace`)}\n\n${chalk().yellow('STEP 2:')}\n${chalk().white('Run app and observe any extra errors')}\n\n${chalk().yellow('IF ALL HOPE IS LOST:')}\nRaise new issue and copy this SUMMARY box output at:\n${chalk().white('https://github.com/pavjacko/renative/issues')}\nand we will try to help!\n\n`);\n    }\n};\n\nconst _handleProvisioningIssues = async (c, e, msg) => {\n    const provisioningStyle = getConfigProp(c, c.platform, 'provisioningStyle');\n    // Sometimes xcodebuild reports Automatic signing is disabled but it could be keychain not accepted by user\n    const isProvAutomatic = provisioningStyle === 'Automatic';\n    const proAutoText = isProvAutomatic\n        ? ''\n        : `${chalk().white('[4]>')} Switch to automatic signing for appId: ${\n            c.runtime.appId\n        } , platform: ${c.platform}, scheme: ${c.runtime.scheme}`;\n    const fixCommand = `rnv crypto updateProfile -p ${c.platform} -s ${c.runtime.scheme}`;\n    const workspacePath = chalk().white(\n        `${getAppFolder(c, c.platform)}/RNVApp.xcworkspace`\n    );\n    logError(e);\n    logWarning(`${msg}. To fix try:\n${chalk().white(\n        '[1]>'\n    )} Configure your certificates, provisioning profiles correctly manually\n${chalk().white('[2]>')} Try to generate matching profiles with ${chalk().white(\n    fixCommand\n)} (you need correct priviledges in apple developer portal)\n${chalk().white(\n        '[3]>'\n    )} Open generated project in Xcode: ${\n    workspacePath\n} and debug from there (Sometimes this helps for the first-time builds)\n${proAutoText}`);\n    if (isProvAutomatic) return false;\n    const { confirmAuto } = await inquirer.prompt({\n        name: 'confirmAuto',\n        message: 'Switch to automatic signing?',\n        type: 'confirm'\n    });\n    if (confirmAuto) {\n        await _setAutomaticSigning(c);\n        return Promise.reject('Updated. Re-run your last command');\n        // TODO: Tot picking up if re-run from here. forcing users to do it themselves for now\n        // await configureXcodeProject(c, c.platform);\n        // return runXcodeProject(c);\n    }\n};\n\nconst _setAutomaticSigning = async (c) => {\n    logTask(`_setAutomaticSigning:${c.platform}`);\n\n    const scheme = c.files.appConfig?.config?.platforms?.[c.platform]?.buildSchemes?.[\n            c.runtime.scheme\n        ];\n    if (scheme) {\n        scheme.provisioningStyle = 'Automatic';\n        writeFileSync(c.paths.appConfig.config, c.files.appConfig.config);\n        logSuccess(`Succesfully updated ${c.paths.appConfig.config}`);\n    } else {\n        return Promise.reject(\n            `Failed to update ${c.paths.appConfig?.config}.\"platforms\": { \"${\n                c.platform\n            }\": { buildSchemes: { \"${c.runtime.scheme}\" ... Object is null. Try update file manually`\n        );\n    }\n};\n\nconst _setDevelopmentTeam = async (c, teamID) => {\n    logTask(`_setDevelopmentTeam:${teamID}`);\n\n    const plat = c.files.appConfig?.config?.platforms?.[c.platform];\n    if (plat) {\n        plat.teamID = teamID;\n        writeFileSync(c.paths.appConfig.config, c.files.appConfig.config);\n        logSuccess(`Succesfully updated ${c.paths.appConfig.config}`);\n    } else {\n        return Promise.reject(\n            `Failed to update ${c.paths.appConfig?.config}.\"platforms\": { \"${\n                c.platform\n            }\" ... Object is null. Try update file manually`\n        );\n    }\n};\n\nconst composeXcodeArgsFromCLI = (string) => {\n    const spacesReplaced = string.replace(\n        /\\s(?=(?:[^'\"`]*(['\"`])[^'\"`]*\\1)*[^'\"`]*$)/g,\n        '&&&'\n    ); // replaces spaces outside quotes with &&& for easy split\n    const keysAndValues = spacesReplaced.split('&&&');\n    const unescapedValues = keysAndValues.map(s => s\n        .replace(/'/g, '')\n        .replace(/\"/g, '')\n        .replace(/\\\\/g, '')); // removes all quotes or backslashes\n\n    return unescapedValues;\n};\n\nexport const buildXcodeProject = async (c) => {\n    logTask('buildXcodeProject');\n\n    const { platform } = c;\n\n    const appFolderName = getAppFolderName(c, platform);\n    const runScheme = getConfigProp(c, platform, 'runScheme', 'Debug');\n\n    let destinationPlatform = '';\n    switch (c.platform) {\n        case TVOS: {\n            if (c.program.device) {\n                destinationPlatform = 'tvOS';\n            } else {\n                destinationPlatform = 'tvOS Simulator';\n            }\n            break;\n        }\n        case IOS: {\n            if (c.program.device) {\n                destinationPlatform = 'iOS';\n            } else {\n                destinationPlatform = 'iOS Simulator';\n            }\n            break;\n        }\n        default:\n            logError(`platform ${c.platform} not supported`);\n    }\n\n    const scheme = getConfigProp(c, platform, 'scheme');\n    const appPath = getAppFolder(c);\n    const buildPath = path.join(appPath, `build/${scheme}`);\n    const allowProvisioningUpdates = getConfigProp(\n        c,\n        platform,\n        'allowProvisioningUpdates',\n        true\n    );\n    const ignoreLogs = getConfigProp(c, platform, 'ignoreLogs');\n    let ps = '';\n    if (c.program.xcodebuildArgs) {\n        ps = c.program.xcodebuildArgs;\n    }\n    const p = [];\n\n    if (!ps.includes('-workspace')) {\n        p.push('-workspace');\n        p.push(`${appPath}/${appFolderName}.xcworkspace`);\n    }\n    if (!ps.includes('-scheme')) {\n        p.push('-scheme');\n        p.push(scheme);\n    }\n    if (!ps.includes('-configuration')) {\n        p.push('-configuration');\n        p.push(runScheme);\n    }\n    if (!ps.includes('-derivedDataPath')) {\n        p.push('-derivedDataPath');\n        p.push(buildPath);\n    }\n    if (!ps.includes('-destination')) {\n        p.push('-destination');\n        p.push(`platform=${destinationPlatform},name=${c.runtime.target}`);\n    }\n\n    p.push('build');\n\n    if (allowProvisioningUpdates && !ps.includes('-allowProvisioningUpdates')) { p.push('-allowProvisioningUpdates'); }\n    if (ignoreLogs && !ps.includes('-quiet')) p.push('-quiet');\n\n    logTask('buildXcodeProject', 'STARTING xcodebuild BUILD...');\n\n    if (c.buildConfig.platforms[platform].runScheme === 'Release') {\n        await executeAsync(c, `xcodebuild ${ps} ${p.join(' ')}`);\n        logSuccess(\n            `Your Build is located in ${chalk().cyan(buildPath)} .`\n        );\n    }\n\n    const args = ps !== '' ? [...composeXcodeArgsFromCLI(ps), ...p] : p;\n\n    logDebug('xcodebuild args', args);\n\n    return executeAsync('xcodebuild', { rawCommand: { args } }).then(() => {\n        logSuccess(`Your Build is located in ${chalk().cyan(buildPath)} .`);\n    });\n};\n\nconst archiveXcodeProject = (c) => {\n    logTask('archiveXcodeProject');\n    const { platform } = c;\n\n    const appFolderName = getAppFolderName(c, platform);\n    const runScheme = getConfigProp(c, platform, 'runScheme', 'Debug');\n    let sdk = getConfigProp(c, platform, 'sdk');\n    if (!sdk) {\n        if (platform === IOS) sdk = 'iphoneos';\n        if (platform === TVOS) sdk = 'appletvos';\n        if (platform === MACOS) sdk = 'macosx';\n    }\n    const sdkArr = [sdk];\n\n    const appPath = getAppFolder(c);\n    const exportPath = path.join(appPath, 'release');\n\n    const scheme = getConfigProp(c, platform, 'scheme');\n    const allowProvisioningUpdates = getConfigProp(\n        c,\n        platform,\n        'allowProvisioningUpdates',\n        true\n    );\n    const ignoreLogs = getConfigProp(c, platform, 'ignoreLogs');\n    const exportPathArchive = `${exportPath}/${scheme}.xcarchive`;\n    let ps = '';\n    if (c.program.xcodebuildArchiveArgs) {\n        ps = c.program.xcodebuildArchiveArgs;\n    }\n    const p = [];\n\n    if (!ps.includes('-workspace')) {\n        p.push('-workspace');\n        p.push(`${appPath}/${appFolderName}.xcworkspace`);\n    }\n    if (!ps.includes('-scheme')) {\n        p.push('-scheme');\n        p.push(scheme);\n    }\n    if (!ps.includes('-sdk')) {\n        p.push('-sdk');\n        p.push(...sdkArr);\n    }\n    if (!ps.includes('-configuration')) {\n        p.push('-configuration');\n        p.push(runScheme);\n    }\n    p.push('archive');\n    if (!ps.includes('-archivePath')) {\n        p.push('-archivePath');\n        p.push(exportPathArchive);\n    }\n\n    if (allowProvisioningUpdates && !ps.includes('-allowProvisioningUpdates')) { p.push('-allowProvisioningUpdates'); }\n    if (ignoreLogs && !ps.includes('-quiet')) p.push('-quiet');\n    // if (sdk === 'iphonesimulator') p.push('ONLY_ACTIVE_ARCH=NO', \"-destination='name=iPhone 7,OS=10.2'\");\n\n    logTask('archiveXcodeProject', 'STARTING xcodebuild ARCHIVE...');\n\n\n    const args = ps !== '' ? [...composeXcodeArgsFromCLI(ps), ...p] : p;\n\n    logDebug('xcodebuild args', args);\n\n    return executeAsync('xcodebuild', { rawCommand: { args } }).then(() => {\n        logSuccess(`Your Archive is located in ${chalk().cyan(exportPath)} .`);\n    });\n};\n\nconst exportXcodeProject = async (c) => {\n    logTask('exportXcodeProject');\n\n    const { platform } = c;\n\n    await archiveXcodeProject(c);\n\n    const appPath = getAppFolder(c);\n    const exportPath = path.join(appPath, 'release');\n\n    const scheme = getConfigProp(c, platform, 'scheme');\n    const allowProvisioningUpdates = getConfigProp(\n        c,\n        platform,\n        'allowProvisioningUpdates',\n        true\n    );\n    const ignoreLogs = getConfigProp(c, platform, 'ignoreLogs');\n\n    let ps = '';\n    if (c.program.xcodebuildExportArgs) {\n        ps = c.program.xcodebuildExportArgs;\n    }\n    const p = ['-exportArchive'];\n\n    if (!ps.includes('-archivePath')) {\n        p.push(`-archivePath ${exportPath}/${scheme}.xcarchive`);\n    }\n    if (!ps.includes('-exportOptionsPlist')) {\n        p.push(`-exportOptionsPlist ${appPath}/exportOptions.plist`);\n    }\n    if (!ps.includes('-exportPath')) {\n        p.push(`-exportPath ${exportPath}`);\n    }\n\n    if (allowProvisioningUpdates && !ps.includes('-allowProvisioningUpdates')) { p.push('-allowProvisioningUpdates'); }\n    if (ignoreLogs && !ps.includes('-quiet')) p.push('-quiet');\n\n    logDebug('running', p);\n\n    logTask('exportXcodeProject', 'STARTING xcodebuild EXPORT...');\n\n    return executeAsync(c, `xcodebuild ${p.join(' ')}`).then(() => {\n        logSuccess(`Your IPA is located in ${chalk().cyan(exportPath)} .`);\n    });\n};\n\nexport const packageBundleForXcode = (c, isDev = false) => {\n    logTask('packageBundleForXcode');\n    // const { maxErrorLength } = c.program;\n    const args = [\n        'bundle',\n        '--platform',\n        'ios',\n        '--dev',\n        isDev,\n        '--assets-dest',\n        `platformBuilds/${c.runtime.appId}_${c.platform}`,\n        '--entry-file',\n        `${c.buildConfig.platforms[c.platform].entryFile}.js`,\n        '--bundle-output',\n        `${getAppFolder(c, c.platform)}/main.jsbundle`\n    ];\n\n    if (c.program.info) {\n        args.push('--verbose');\n    }\n\n    return executeAsync(c, `node ${doResolve(\n        'react-native'\n    )}/local-cli/cli.js ${args.join(' ')} --config=metro.config.js`, { env: { ...generateEnvVars(c) } });\n};\n\nexport const getAppFolderName = (c, platform) => {\n    const projectFolder = getConfigProp(c, platform, 'projectFolder');\n    if (projectFolder) {\n        return projectFolder;\n    }\n    return platform === IOS ? 'RNVApp' : 'RNVAppTVOS';\n};\n\n// Resolve or reject will not be called so this will keep running\nconst runAppleLog = c => new Promise(() => {\n    logTask('runAppleLog');\n    const filter = c.program.filter || 'RNV';\n    const child = child_process.execFile(\n        'xcrun',\n        [\n            'simctl',\n            'spawn',\n            'booted',\n            'log',\n            'stream',\n            '--predicate',\n            `eventMessage contains \"${filter}\"`\n        ],\n        { stdio: 'inherit', customFds: [0, 1, 2] }\n    );\n        // use event hooks to provide a callback to execute when data are available:\n    child.stdout.on('data', (data) => {\n        const d = data.toString();\n        if (d.toLowerCase().includes('error')) {\n            logRaw(chalk().red(d));\n        } else if (d.toLowerCase().includes('success')) {\n            logRaw(chalk().green(d));\n        } else {\n            logRaw(d);\n        }\n    });\n});\n\nconst configureXcodeProject = async (c) => {\n    logTask('configureXcodeProject');\n    const { device } = c.program;\n    const { platform } = c;\n    const bundlerIp = device ? getIP() : 'localhost';\n    const appFolder = getAppFolder(c);\n    c.runtime.platformBuildsProjectPath = `${appFolder}/RNVApp.xcworkspace`;\n    const appFolderName = getAppFolderName(c, platform);\n    const bundleAssets = getConfigProp(c, platform, 'bundleAssets') === true;\n    // INJECTORS\n    c.pluginConfigiOS = {\n        podfileInject: '',\n        staticFrameworks: [],\n        staticPodDefinition: '',\n        exportOptions: '',\n        embeddedFonts: [],\n        embeddedFontSources: [],\n        ignoreProjectFonts: [],\n        pluginAppDelegateImports: '',\n        pluginAppDelegateMethods: '',\n        appDelegateMethods: {\n            application: {\n                didFinishLaunchingWithOptions: [],\n                applicationDidBecomeActive: [],\n                open: [],\n                supportedInterfaceOrientationsFor: [],\n                didReceiveRemoteNotification: [],\n                didFailToRegisterForRemoteNotificationsWithError: [],\n                didReceive: [],\n                didRegister: [],\n                didRegisterForRemoteNotificationsWithDeviceToken: [],\n                continue: []\n            },\n            userNotificationCenter: {\n                willPresent: []\n            }\n        },\n        podfileSources: []\n    };\n\n    // FONTS\n    // parsePlugins(c, platform, (plugin, pluginPlat) => {\n    //     // const ignoreProjectFonts = getFlavouredProp(\n    //     //     c,\n    //     //     pluginPlat,\n    //     //     'ignoreProjectFonts'\n    //     // );\n    //\n    //     // TODO: enable this once mmoved to modular_headers Podfile\n    //     // if (ignoreProjectFonts) {\n    //     //     ignoreProjectFonts.forEach((v) => {\n    //     //         if (!c.pluginConfigiOS.ignoreProjectFonts.includes(v)) {\n    //     //             logDebug(`Igonoring font: ${v}`);\n    //     //             c.pluginConfigiOS.ignoreProjectFonts.push(v);\n    //     //         }\n    //     //     });\n    //     // }\n    // });\n    const embeddedFontSourcesCheck = [];\n    parseFonts(c, (font, dir) => {\n        if (font.includes('.ttf') || font.includes('.otf')) {\n            const key = font.split('.')[0];\n            const includedFonts = getConfigProp(c, c.platform, 'includedFonts');\n            if (\n                includedFonts\n                && (includedFonts.includes('*') || includedFonts.includes(key))\n            ) {\n                const fontSource = path.join(dir, font);\n                if (fsExistsSync(fontSource)) {\n                    const fontFolder = path.join(appFolder, 'fonts');\n                    mkdirSync(fontFolder);\n                    const fontDest = path.join(fontFolder, font);\n                    copyFileSync(fontSource, fontDest);\n\n                    if (\n                        !c.pluginConfigiOS.ignoreProjectFonts.includes(font)\n                        && !embeddedFontSourcesCheck.includes(font)\n                    ) {\n                        c.pluginConfigiOS.embeddedFontSources.push(fontSource);\n                        embeddedFontSourcesCheck.push(font);\n                    }\n\n                    if (!c.pluginConfigiOS.embeddedFonts.includes(font)) {\n                        c.pluginConfigiOS.embeddedFonts.push(font);\n                    }\n                } else {\n                    logWarning(\n                        `Font ${chalk().white(\n                            fontSource\n                        )} doesn't exist! Skipping.`\n                    );\n                }\n            }\n        }\n    });\n\n    // CHECK TEAM ID IF DEVICE\n    const tId = getConfigProp(c, platform, 'teamID');\n    if (device && (!tId || tId === '')) {\n        logError(\n            `You're missing teamID in your ${chalk().white(\n                c.paths.appConfig.config\n            )} => .platforms.${platform}.teamID . you will not be able to build ${platform} app for device!`\n        );\n    }\n\n    await copyAssetsFolder(c, platform);\n    await copyAppleAssets(c, platform, appFolderName);\n    await parseAppDelegate(\n        c,\n        platform,\n        appFolder,\n        appFolderName,\n        bundleAssets,\n        bundlerIp\n    );\n    await parseExportOptionsPlist(c, platform);\n    await parseXcscheme(c, platform);\n    await parsePodFile(c, platform);\n    await parseEntitlementsPlist(c, platform);\n    await parseInfoPlist(c, platform);\n    await copyBuildsFolder(c, platform);\n    await runCocoaPods(c);\n    await parseXcodeProject(c, platform);\n    return true;\n};\n\nexport {\n    runCocoaPods,\n    copyAppleAssets,\n    configureXcodeProject,\n    exportXcodeProject,\n    archiveXcodeProject,\n    runAppleLog\n};\n"],"file":"index.js"}