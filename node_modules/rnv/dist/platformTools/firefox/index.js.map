{"version":3,"sources":["../../../src/platformTools/firefox/index.js"],"names":["childProcess","require","launchKaiOSSimulator","c","Promise","resolve","reject","buildConfig","sdks","KAIOS_SDK","paths","workspace","config","chalk","white","bold","ePath","path","join","fs","existsSync","exec","err","configureKaiOSProject","platform","configureProject","appFolder","templateFolder","manifestFilePath","manifestFilePath2","manifestFile","JSON","parse","readFileSync","name","description","developer","stringify","runFirefoxProject","then","catch","e","buildFirefoxProject"],"mappings":";;AAEA;AACA;AACA;AACA;;;;;;;AAOA;AACA;AACA;;;;AAIA;AACA;AACA;;AAEA,GAAMA,CAAAA,YAAY,CAAGC,OAAO,CAAC,eAAD,CAA5B;;AAEA,GAAMC,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAAAC,CAAC,QAAI,IAAIC,CAAAA,OAAJ,CAAY,SAACC,OAAD,CAAUC,MAAV,CAAqB;AAC/D,oBAAQ,sBAAR;;AAEA,GAAI,kBAACH,CAAC,CAACI,WAAH,oCAAC,eAAeC,IAAhB,eAAC,oBAAqBC,SAAtB,CAAJ,CAAqC;AACjCH,MAAM;AACCG,oBADD;AAEEN,CAAC,CAACO,KAAF,CAAQC,SAAR,CAAkBC,MAFpB;AAGwEC,eAAMC,KAAN,CAAYC,IAAZ;AACtE,0CADsE,CAHxE,CAAN;;;AAOA;AACH;;AAED,GAAMC,CAAAA,KAAK,CAAG;AACVC,cAAKC,IAAL,kBAAUf,CAAC,CAACI,WAAZ,qCAAU,gBAAeC,IAAzB,eAAU,qBAAqBC,SAA/B,CADU,CAAd;;;AAIA,GAAI,CAACU,YAAGC,UAAH,CAAcJ,KAAd,CAAL,CAA2B;AACvBV,MAAM,iCAAiCU,KAAjC,CAAN;AACA;AACH;;AAEDhB,YAAY,CAACqB,IAAb,SAA0BL,KAA1B,CAAmC,SAACM,GAAD,CAAS;AACxC,GAAIA,GAAJ,CAAS;AACLhB,MAAM,CAACgB,GAAD,CAAN;AACA;AACH;AACDjB,OAAO;AACV,CAND;AAOH,CA9BiC,CAAJ,EAA9B,C;;AAgCA,GAAMkB,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,CAAOpB,CAAP,CAAUqB,QAAV;AAC1B,oBAAQ,uBAAR,EAD0B;;AAGrB,uBAAiBrB,CAAjB,CAAoBqB,QAApB,CAHqB;;AAKpB,oCAAiBrB,CAAjB,CAAoBqB,QAApB,CALoB;AAMpB,iCAAwBrB,CAAxB,CAA2BqB,QAA3B,CANoB;AAOpBC,gBAAgB,CAACtB,CAAD,CAAIqB,QAAJ,CAPI;AAQnB,oCAAiBrB,CAAjB,CAAoBqB,QAApB,CARmB,wEAA9B,C;;;AAWA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACtB,CAAD,CAAIqB,QAAJ,QAAiB,IAAIpB,CAAAA,OAAJ,CAAY,SAACC,OAAD,CAAa;AAC/D,wCAA4BmB,QAA5B;;AAEA,GAAI,CAAC,uBAAiBrB,CAAjB,CAAoBqB,QAApB,CAA8BnB,OAA9B,CAAL,CAA6C;;AAE7C,GAAMqB,CAAAA,SAAS,CAAG,yBAAavB,CAAb,CAAgBqB,QAAhB,CAAlB;AACA,GAAMG,CAAAA,cAAc,CAAG,iCAAqBxB,CAArB,CAAwBqB,QAAxB,CAAvB;;AAEA,GAAMI,CAAAA,gBAAgB,CAAGX,cAAKC,IAAL,CAAUS,cAAV,CAA0B,iBAA1B,CAAzB;AACA,GAAME,CAAAA,iBAAiB,CAAGZ,cAAKC,IAAL,CAAUQ,SAAV,CAAqB,iBAArB,CAA1B;AACA,GAAMI,CAAAA,YAAY,CAAGC,IAAI,CAACC,KAAL,CAAWb,YAAGc,YAAH,CAAgBL,gBAAhB,CAAX,CAArB;;AAEAE,YAAY,CAACI,IAAb,IAAuB,wBAAY/B,CAAZ,CAAeqB,QAAf,CAAvB;AACAM,YAAY,CAACK,WAAb,IAA8B,8BAAkBhC,CAAlB,CAAqBqB,QAArB,CAA9B;AACAM,YAAY,CAACM,SAAb,CAAyB,yBAAajC,CAAb,CAAgBqB,QAAhB,CAAzB;;AAEA;AACIK,iBADJ;AAEIE,IAAI,CAACM,SAAL,CAAeP,YAAf,CAA6B,IAA7B,CAAmC,CAAnC,CAFJ;;;AAKAzB,OAAO;AACV,CAtByC,CAAjB,EAAzB;;AAwBA,GAAMiC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACnC,CAAD,CAAIqB,QAAJ,QAAiB,IAAIpB,CAAAA,OAAJ,CAAY,SAACC,OAAD,CAAUC,MAAV,CAAqB;AACxE,yCAA6BkB,QAA7B;;AAEA,kBAASrB,CAAT,CAAYqB,QAAZ;AACKe,IADL,CACU,iBAAMrC,CAAAA,oBAAoB,CAACC,CAAD,CAAIqB,QAAJ,CAA1B,EADV;AAEKe,IAFL,CAEU,iBAAMlC,CAAAA,OAAO,EAAb,EAFV;AAGKmC,KAHL,CAGW,SAAAC,CAAC,QAAInC,CAAAA,MAAM,CAACmC,CAAD,CAAV,EAHZ;AAIH,CAP0C,CAAjB,EAA1B,C;;AASA,GAAMC,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACvC,CAAD,CAAIqB,QAAJ,QAAiB,IAAIpB,CAAAA,OAAJ,CAAY,SAACC,OAAD,CAAUC,MAAV,CAAqB;AAC1E,2CAA+BkB,QAA/B;;AAEA,kBAASrB,CAAT,CAAYqB,QAAZ;AACKe,IADL,CACU,iBAAMlC,CAAAA,OAAO,EAAb,EADV;AAEKmC,KAFL,CAEW,SAAAC,CAAC,QAAInC,CAAAA,MAAM,CAACmC,CAAD,CAAV,EAFZ;AAGH,CAN4C,CAAjB,EAA5B,C","sourcesContent":["/* eslint-disable import/no-cycle */\n\nimport path from 'path';\nimport fs from 'fs';\nimport chalk from 'chalk';\nimport {\n    getAppFolder,\n    getAppTitle,\n    getAppTemplateFolder,\n    getAppDescription,\n    getAppAuthor,\n} from '../../common';\nimport { logTask } from '../../systemTools/logger';\nimport { isPlatformActive } from '..';\nimport {\n    copyBuildsFolder,\n    copyAssetsFolder\n} from '../../projectTools/projectParser';\nimport { KAIOS_SDK } from '../../constants';\nimport { getRealPath, fsWriteFileSync } from '../../systemTools/fileutils';\nimport { buildWeb, configureCoreWebProject } from '../web';\n\nconst childProcess = require('child_process');\n\nconst launchKaiOSSimulator = c => new Promise((resolve, reject) => {\n    logTask('launchKaiOSSimulator');\n\n    if (!c.buildConfig?.sdks?.KAIOS_SDK) {\n        reject(\n            `${KAIOS_SDK} is not configured in your ${\n                c.paths.workspace.config\n            } file. Make sure you add location to your Kaiosrt App path similar to: ${chalk.white.bold(\n                '\"KAIOS_SDK\": \"/Applications/Kaiosrt.app\"'\n            )}`\n        );\n        return;\n    }\n\n    const ePath = getRealPath(\n        path.join(c.buildConfig?.sdks?.KAIOS_SDK)\n    );\n\n    if (!fs.existsSync(ePath)) {\n        reject(`Can't find emulator at path: ${ePath}`);\n        return;\n    }\n\n    childProcess.exec(`open ${ePath}`, (err) => {\n        if (err) {\n            reject(err);\n            return;\n        }\n        resolve();\n    });\n});\n\nconst configureKaiOSProject = async (c, platform) => {\n    logTask('configureKaiOSProject');\n\n    if (!isPlatformActive(c, platform)) return;\n\n    await copyAssetsFolder(c, platform);\n    await configureCoreWebProject(c, platform);\n    await configureProject(c, platform);\n    return copyBuildsFolder(c, platform);\n};\n\nconst configureProject = (c, platform) => new Promise((resolve) => {\n    logTask(`configureProject:${platform}`);\n\n    if (!isPlatformActive(c, platform, resolve)) return;\n\n    const appFolder = getAppFolder(c, platform);\n    const templateFolder = getAppTemplateFolder(c, platform);\n\n    const manifestFilePath = path.join(templateFolder, 'manifest.webapp');\n    const manifestFilePath2 = path.join(appFolder, 'manifest.webapp');\n    const manifestFile = JSON.parse(fs.readFileSync(manifestFilePath));\n\n    manifestFile.name = `${getAppTitle(c, platform)}`;\n    manifestFile.description = `${getAppDescription(c, platform)}`;\n    manifestFile.developer = getAppAuthor(c, platform);\n\n    fsWriteFileSync(\n        manifestFilePath2,\n        JSON.stringify(manifestFile, null, 2)\n    );\n\n    resolve();\n});\n\nconst runFirefoxProject = (c, platform) => new Promise((resolve, reject) => {\n    logTask(`runFirefoxProject:${platform}`);\n\n    buildWeb(c, platform)\n        .then(() => launchKaiOSSimulator(c, platform))\n        .then(() => resolve())\n        .catch(e => reject(e));\n});\n\nconst buildFirefoxProject = (c, platform) => new Promise((resolve, reject) => {\n    logTask(`buildFirefoxProject:${platform}`);\n\n    buildWeb(c, platform)\n        .then(() => resolve())\n        .catch(e => reject(e));\n});\n\nexport {\n    launchKaiOSSimulator,\n    configureKaiOSProject,\n    runFirefoxProject,\n    buildFirefoxProject\n};\n"],"file":"index.js"}