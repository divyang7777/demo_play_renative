{"version":3,"sources":["../../src/sdk-firefox/index.js"],"names":["childProcess","require","launchKaiOSSimulator","c","Promise","resolve","reject","buildConfig","sdks","KAIOS_SDK","paths","workspace","config","white","bold","ePath","path","join","exec","err","configureKaiOSProject","platform","runtime","platformBuildsProjectPath","configureProject","appFolder","templateFolder","manifestFilePath","manifestFilePath2","manifestFile","JSON","parse","name","description","developer","stringify","runFirefoxProject","buildFirefoxProject"],"mappings":"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","sourcesContent":["import path from 'path';\nimport {\n    getPlatformProjectDir,\n    getTemplateProjectDir,\n    getAppTitle,\n    getAppDescription,\n    getAppAuthor,\n} from '../core/common';\nimport { fsExistsSync, getRealPath, fsWriteFileSync, fsReadFileSync } from '../core/systemManager/fileutils';\nimport { chalk, logTask } from '../core/systemManager/logger';\nimport { isPlatformActive } from '../core/platformManager';\nimport {\n    copyBuildsFolder,\n    copyAssetsFolder\n} from '../core/projectManager/projectParser';\nimport { KAIOS_SDK } from '../core/constants';\n\nimport { buildWeb, configureCoreWebProject } from '../sdk-webpack';\n\nconst childProcess = require('child_process');\n\nconst launchKaiOSSimulator = c => new Promise((resolve, reject) => {\n    logTask('launchKaiOSSimulator');\n\n    if (!c.buildConfig?.sdks?.KAIOS_SDK) {\n        reject(\n            `${KAIOS_SDK} is not configured in your ${\n                c.paths.workspace.config\n            } file. Make sure you add location to your Kaiosrt App path similar to: ${chalk().white.bold(\n                '\"KAIOS_SDK\": \"/Applications/Kaiosrt.app\"'\n            )}`\n        );\n        return;\n    }\n\n    const ePath = getRealPath(\n        path.join(c.buildConfig?.sdks?.KAIOS_SDK)\n    );\n\n    if (!fsExistsSync(ePath)) {\n        reject(`Can't find emulator at path: ${ePath}`);\n        return;\n    }\n\n    childProcess.exec(`open ${ePath}`, (err) => {\n        if (err) {\n            reject(err);\n            return;\n        }\n        resolve();\n    });\n});\n\nconst configureKaiOSProject = async (c) => {\n    logTask('configureKaiOSProject');\n\n    const { platform } = c;\n\n    c.runtime.platformBuildsProjectPath = `${getPlatformProjectDir(c)}`;\n\n    if (!isPlatformActive(c, platform)) return;\n\n    await copyAssetsFolder(c, platform);\n    await configureCoreWebProject(c);\n    await configureProject(c);\n    return copyBuildsFolder(c, platform);\n};\n\nconst configureProject = c => new Promise((resolve) => {\n    logTask('configureProject');\n    const { platform } = c;\n\n    if (!isPlatformActive(c, platform, resolve)) return;\n\n    const appFolder = getPlatformProjectDir(c);\n    const templateFolder = getTemplateProjectDir(c, platform);\n\n    const manifestFilePath = path.join(templateFolder, 'manifest.webapp');\n    const manifestFilePath2 = path.join(appFolder, 'manifest.webapp');\n    const manifestFile = JSON.parse(fsReadFileSync(manifestFilePath));\n\n    manifestFile.name = `${getAppTitle(c, platform)}`;\n    manifestFile.description = `${getAppDescription(c, platform)}`;\n    manifestFile.developer = getAppAuthor(c, platform);\n\n    fsWriteFileSync(\n        manifestFilePath2,\n        JSON.stringify(manifestFile, null, 2)\n    );\n\n    resolve();\n});\n\nconst runFirefoxProject = async (c) => {\n    logTask('runFirefoxProject');\n    const { platform } = c;\n\n    await buildWeb(c);\n    await launchKaiOSSimulator(c, platform);\n    return true;\n};\n\nconst buildFirefoxProject = async (c) => {\n    logTask('buildFirefoxProject');\n\n    await buildWeb(c);\n    return true;\n};\n\nexport {\n    launchKaiOSSimulator,\n    configureKaiOSProject,\n    runFirefoxProject,\n    buildFirefoxProject\n};\n"],"file":"index.js"}