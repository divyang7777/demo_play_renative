{"version":3,"sources":["../../../src/core/systemManager/fileutils.js"],"names":["getConfigProp","doResolve","isSystemWin","configureFilesystem","_getConfigProp","_doResolve","_isSystemWin","fsWriteFileSync","dest","data","encoding","fs","writeFileSync","fsCopyFileSync","source","copyFileSync","fsExistsSync","existsSync","fsReaddirSync","readdirSync","fsLstatSync","lstatSync","fsReadFileSync","readFileSync","fsChmodSync","flag","chmodSync","fsRenameSync","arg1","arg2","renameSync","fsStatSync","statSync","fsMkdirSync","mkdirSync","fsUnlinkSync","unlinkSync","fsSymlinkSync","symlinkSync","fsReadFile","readFile","fsReaddir","readdir","_getSanitizedPath","origPath","timestampPathsConfig","paths","length","timestamp","pths","includes","ext","path","extname","fileName","basename","dirPath","dirname","newPath","join","target","skipOverride","targetFile","indexOf","isDirectory","src","dst","Buffer","compare","e","SKIP_INJECT_EXTENSIONS","writeCleanFile","destination","overrides","c","pFile","test","pFileClean","forEach","v","regEx","RegExp","pattern","replace","override","occurences","match","occ","val","configVal","platform","readCleanFile","from","copyFileWithInjectSync","injectObject","invalidatePodsChecksum","appFolder","project","builds","dir","runtime","appId","podChecksumPath","copyFolderRecursiveSync","convertSvg","files","targetFolder","file","curSource","jsDest","saveAsJs","copyFolderContentsRecursiveSync","skipPaths","copyFolderContentsRecursive","Promise","resolve","reject","err","Svg2Js","createSync","removeDir","pth","callback","shelljs","mkdir","cleanFolder","d","removeFilesSync","filePaths","filePath","removeDirsSync","dirPaths","i","removeDirSync","removeDirs","allFolders","deletedFolders","_dir","_rmSelf","rmSelf","undefined","x","e2","rmdirSync","obj","spaces","addNewLine","output","JSON","stringify","toString","writeObjectSync","readObjectSync","sanitize","parse","sanitizeDynamicRefs","_refs","sanitizeDynamicProps","white","updateObjectSync","updateObj","getRealPath","p","key","original","startsWith","rnv","home","workspace","_refToValue","ref","split","realPath","reduce","o","arrayMerge","destinationArray","sourceArray","jointArray","concat","uniqueArray","filter","item","index","_arrayMergeOverride","Array","isArray","Object","keys","fixResolve","text","matches","newText","forceForwardPaths","props","configProps","runtimeProps","pk","propVal","pk2","pk3","newKey","mergeObjects","obj1","obj2","dynamicRefs","replaceArrays","updateConfigFile","update","globalConfigPath","configContents","androidSdk","sdks","ANDROID_SDK","tizenSdk","TIZEN_SDK","webosSdk","WEBOS_SDK","replaceHomeFolder","process","env","USERPROFILE","HOME","getFileListSync","results","list","fileFixed","stat","push"],"mappings":"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","sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport rimraf from 'rimraf';\nimport Svg2Js from 'svg2js';\nimport shelljs from 'shelljs';\nimport merge from 'deepmerge';\nimport ncp from 'ncp';\nimport { chalk, logDebug, logError, logWarning } from './logger';\n\nlet getConfigProp;\nlet doResolve;\nlet isSystemWin;\nexport const configureFilesystem = (_getConfigProp, _doResolve, _isSystemWin) => {\n    getConfigProp = _getConfigProp;\n    doResolve = _doResolve;\n    isSystemWin = _isSystemWin;\n};\n\nexport const fsWriteFileSync = (dest, data, encoding) => {\n    // console.log('FS_WRITE', dest);\n    fs.writeFileSync(dest, data, encoding);\n};\n\nexport const fsCopyFileSync = (source, dest) => {\n    // console.log('FS_COPY', source);\n    fs.copyFileSync(source, dest);\n};\n\nexport const fsExistsSync = dest => fs.existsSync(dest);\n\nexport const fsReaddirSync = dest => fs.readdirSync(dest);\n\nexport const fsLstatSync = dest => fs.lstatSync(dest);\n\nexport const fsReadFileSync = dest => fs.readFileSync(dest);\n\nexport const fsChmodSync = (dest, flag) => fs.chmodSync(dest, flag);\n\nexport const fsRenameSync = (arg1, arg2) => fs.renameSync(arg1, arg2);\n\nexport const fsStatSync = arg1 => fs.statSync(arg1);\n\nexport const fsMkdirSync = arg1 => fs.mkdirSync(arg1);\n\nexport const fsUnlinkSync = arg1 => fs.unlinkSync(arg1);\n\nexport const fsSymlinkSync = (arg1, arg2) => {\n    fs.symlinkSync(arg1, arg2);\n};\n\nexport const fsReadFile = (arg1, arg2) => {\n    fs.readFile(arg1, arg2);\n};\n\nexport const fsReaddir = (arg1, arg2) => fs.readdir(arg1, arg2);\n\n\nconst _getSanitizedPath = (origPath, timestampPathsConfig) => {\n    if (timestampPathsConfig?.paths?.length && timestampPathsConfig?.timestamp) {\n        const pths = timestampPathsConfig.paths;\n        if (pths.includes(origPath)) {\n            const ext = path.extname(origPath);\n            const fileName = path.basename(origPath, ext);\n            const dirPath = path.dirname(origPath);\n            const newPath = path.join(dirPath, `${fileName}-${timestampPathsConfig.timestamp}${ext}`);\n            return newPath;\n        }\n    }\n    return origPath;\n};\n\nexport const copyFileSync = (source, target, skipOverride, timestampPathsConfig) => {\n    logDebug('copyFileSync', source);\n    let targetFile = target;\n    // if target is a directory a new file with the same name will be created\n    if (source.indexOf('.DS_Store') !== -1) return;\n\n    if (fs.existsSync(target)) {\n        if (fs.lstatSync(target).isDirectory()) {\n            targetFile = path.join(target, path.basename(source));\n        }\n    }\n    if (fs.existsSync(targetFile)) {\n        if (skipOverride) return;\n        const src = fs.readFileSync(source);\n        const dst = fs.readFileSync(targetFile);\n\n        if (Buffer.compare(src, dst) === 0) return;\n    }\n    logDebug('copyFileSync', source, targetFile, 'executed');\n    try {\n        fsCopyFileSync(source, _getSanitizedPath(targetFile, timestampPathsConfig));\n    } catch (e) {\n        logDebug('copyFileSync', e);\n    }\n};\n\nconst SKIP_INJECT_EXTENSIONS = ['.jpg', '.jpeg', '.png', '.svg', '.jar', '.zip'];\nexport const writeCleanFile = (source, destination, overrides, timestampPathsConfig, c) => {\n    // logTask(`writeCleanFile`)\n    // console.log('writeCleanFile', destination);\n    if (!fs.existsSync(source)) {\n        logError(`Cannot write file. source path doesn't exists: ${source}`);\n        return;\n    }\n    if (!fs.existsSync(destination)) {\n        logDebug(\n            `destination path doesn't exists: ${destination}. will create new one`\n        );\n        // return;\n    }\n    const ext = path.extname(source);\n    if (SKIP_INJECT_EXTENSIONS.includes(ext)) {\n        fsCopyFileSync(source, _getSanitizedPath(destination, timestampPathsConfig));\n    } else {\n        const pFile = fs.readFileSync(source, 'utf8');\n        if (/\\ufffd/.test(pFile) === true) {\n            // Handle uncaught binary files\n            fsCopyFileSync(source, _getSanitizedPath(destination, timestampPathsConfig));\n        } else {\n            let pFileClean = pFile;\n            if (overrides?.forEach) {\n                overrides.forEach((v) => {\n                    const regEx = new RegExp(v.pattern, 'g');\n                    pFileClean = pFileClean.replace(regEx, v.override);\n                });\n            }\n            if (c) {\n                const regEx = /{{configProps.([\\s\\S]*?)}}/g;\n                const occurences = pFileClean.match(regEx);\n                if (occurences) {\n                    occurences.forEach((occ) => {\n                        const val = occ.replace('{{configProps.', '').replace('}}', '');\n                        const configVal = getConfigProp(c, c.platform, val, '');\n                        pFileClean = pFileClean.replace(occ, configVal);\n                    });\n                }\n            }\n            fsWriteFileSync(_getSanitizedPath(destination, timestampPathsConfig), pFileClean, 'utf8');\n        }\n    }\n};\n\nexport const readCleanFile = (source, overrides) => {\n    // logTask(`writeCleanFile`)\n    // console.log('readCleanFile', source);\n    if (!fs.existsSync(source)) {\n        logError(`Cannot write file. source path doesn't exists: ${source}`);\n        return;\n    }\n\n    const pFile = fs.readFileSync(source, 'utf8');\n    let pFileClean = pFile;\n    if (overrides?.forEach) {\n        overrides.forEach((v) => {\n            const regEx = new RegExp(v.pattern, 'g');\n            pFileClean = pFileClean.replace(regEx, v.override);\n        });\n    }\n\n    return Buffer.from(pFileClean, 'utf8');\n};\n\nexport const copyFileWithInjectSync = (source, target, skipOverride, injectObject, timestampPathsConfig, c) => {\n    logDebug('copyFileWithInjectSync', source);\n\n\n    let targetFile = target;\n    // if target is a directory a new file with the same name will be created\n    if (source.indexOf('.DS_Store') !== -1) return;\n\n    if (fs.existsSync(target)) {\n        if (fs.lstatSync(target).isDirectory()) {\n            targetFile = path.join(target, path.basename(source));\n        }\n    }\n    if (fs.existsSync(targetFile)) {\n        if (skipOverride) return;\n        const src = readCleanFile(source, injectObject);\n        const dst = fs.readFileSync(targetFile);\n\n        if (Buffer.compare(src, dst) === 0) return;\n    }\n    logDebug('copyFileSync', source, targetFile, 'executed');\n\n    try {\n        writeCleanFile(\n            source,\n            targetFile,\n            injectObject,\n            timestampPathsConfig,\n            c\n        );\n    } catch (e) {\n        logDebug('copyFileSync', e);\n    }\n};\n\nexport const invalidatePodsChecksum = (c) => {\n    const appFolder = path.join(\n        c.paths.project.builds.dir,\n        `${c.runtime.appId}_${c.platform}`\n    );\n    const podChecksumPath = path.join(appFolder, 'Podfile.checksum');\n    if (fs.existsSync(podChecksumPath)) {\n        fs.unlinkSync(podChecksumPath);\n    }\n};\n\nexport const copyFolderRecursiveSync = (\n    source,\n    target,\n    convertSvg = true,\n    skipOverride,\n    injectObject = null,\n    timestampPathsConfig = null,\n    c\n) => {\n    logDebug('copyFolderRecursiveSync', source, target);\n    if (!fs.existsSync(source)) return;\n\n    let files = [];\n    // check if folder needs to be created or integrated\n    const targetFolder = path.join(target, path.basename(source));\n    if (!fs.existsSync(targetFolder)) {\n        mkdirSync(targetFolder);\n    }\n    // copy\n    if (fs.lstatSync(source).isDirectory()) {\n        files = fs.readdirSync(source);\n        files.forEach((file) => {\n            const curSource = path.join(source, file);\n            if (fs.lstatSync(curSource).isDirectory()) {\n                copyFolderRecursiveSync(curSource, targetFolder,\n                    convertSvg, skipOverride, injectObject, timestampPathsConfig, c);\n            } else if (\n                path.extname(curSource) === '.svg'\n                && convertSvg === true\n            ) {\n                const jsDest = path.join(\n                    targetFolder,\n                    `${path.basename(curSource)}.js`\n                );\n                logDebug(\n                    `file ${curSource} is svg and convertSvg is set to true. converting to ${jsDest}`\n                );\n                saveAsJs(curSource, jsDest);\n            } else if (injectObject !== null) {\n                copyFileWithInjectSync(curSource, targetFolder, skipOverride, injectObject, timestampPathsConfig, c);\n            } else {\n                copyFileSync(curSource, targetFolder, skipOverride, timestampPathsConfig);\n            }\n        });\n    }\n};\n\nexport const copyFolderContentsRecursiveSync = (source, target, convertSvg = true,\n    skipPaths, skipOverride, injectObject = null, timestampPathsConfig = null, c) => {\n    logDebug('copyFolderContentsRecursiveSync', source, target, skipPaths);\n    if (!fs.existsSync(source)) return;\n    let files = [];\n    const targetFolder = path.join(target);\n    if (!fs.existsSync(targetFolder)) {\n        mkdirSync(targetFolder);\n    }\n    if (fs.lstatSync(source).isDirectory()) {\n        files = fs.readdirSync(source);\n        files.forEach((file) => {\n            const curSource = path.join(source, file);\n            if (!skipPaths || (skipPaths && !skipPaths.includes(curSource))) {\n                if (fs.lstatSync(curSource).isDirectory()) {\n                    copyFolderRecursiveSync(curSource, targetFolder, convertSvg,\n                        skipOverride, injectObject, timestampPathsConfig, c);\n                } else if (injectObject !== null) {\n                    // console.log('BAAA', targetFolder);\n                    copyFileWithInjectSync(curSource, targetFolder, skipOverride,\n                        injectObject, timestampPathsConfig, c);\n                } else if (path.extname(curSource) === '.svg' && convertSvg === true) {\n                    const jsDest = path.join(\n                        targetFolder,\n                        `${path.basename(curSource)}.js`\n                    );\n                    logDebug(\n                        `file ${curSource} is svg and convertSvg is set to true. converting to ${jsDest}`\n                    );\n                    saveAsJs(curSource, jsDest);\n                } else {\n                    copyFileSync(curSource, targetFolder, skipOverride, timestampPathsConfig);\n                }\n            }\n        });\n    }\n};\n\nexport const copyFolderContentsRecursive = (\n    source,\n    target,\n    convertSvg = true,\n    skipPaths\n) => new Promise((resolve, reject) => {\n    logDebug('copyFolderContentsRecursive', source, target, skipPaths, convertSvg);\n    if (!fs.existsSync(source)) return;\n    const targetFolder = path.resolve(target);\n    if (!fs.existsSync(targetFolder)) {\n        mkdirSync(targetFolder);\n    }\n    ncp(source, targetFolder, (err) => {\n        if (err) {\n            return reject(err);\n        }\n        return resolve();\n    });\n});\n\nexport const saveAsJs = (source, dest) => {\n    Svg2Js.createSync({\n        source,\n        destination: dest\n    });\n};\n\nexport const removeDir = (pth, callback) => {\n    rimraf(pth, callback);\n};\n\nexport const mkdirSync = (dir) => {\n    if (!dir) return;\n    if (fs.existsSync(dir)) return;\n    try {\n        shelljs.mkdir('-p', dir);\n    } catch (e) {\n        logWarning(`shelljs.mkdir failed for dir: ${dir} with error: ${e}`);\n    }\n};\n\nexport const cleanFolder = d => new Promise((resolve) => {\n    logDebug('cleanFolder', d);\n    removeDir(d, () => {\n        mkdirSync(d);\n        resolve();\n    });\n});\n\nexport const removeFilesSync = (filePaths) => {\n    logDebug('removeFilesSync', filePaths);\n    filePaths.forEach((filePath) => {\n        try {\n            if (fs.existsSync(filePath)) {\n                fs.unlinkSync(filePath);\n            } else {\n                logDebug(`Path ${filePath} does not exist`);\n            }\n        } catch (e) {\n            logError(e);\n        }\n    });\n};\n\nexport const removeDirsSync = (dirPaths) => {\n    logDebug('removeDirsSync', dirPaths);\n\n    for (let i = 0; i < dirPaths.length; i++) {\n        try {\n            removeDirSync(dirPaths[i]);\n        } catch (e) {\n            logError(e);\n        }\n    }\n};\n\n/* eslint-disable no-loop-func */\nexport const removeDirs = dirPaths => new Promise((resolve) => {\n    logDebug('removeDirs', dirPaths);\n    const allFolders = dirPaths.length;\n    let deletedFolders = 0;\n    for (let i = 0; i < allFolders; i++) {\n        rimraf(dirPaths[i], (e) => {\n            if (e) {\n                logError(e);\n            }\n            deletedFolders++;\n            if (deletedFolders >= allFolders) resolve();\n        });\n    }\n    if (allFolders === 0) resolve();\n});\n\nexport const removeDirSync = (_dir, _rmSelf) => {\n    let dir = _dir;\n    let rmSelf = _rmSelf;\n    let files;\n    rmSelf = rmSelf === undefined ? true : rmSelf;\n    dir += '/';\n    try {\n        files = fs.readdirSync(dir);\n    } catch (e) {\n        logDebug('!Oops, directory not exist.');\n        return;\n    }\n    if (files.length > 0) {\n        files.forEach((x) => {\n            try {\n                if (fs.statSync(dir + x).isDirectory()) {\n                    removeDirSync(dir + x);\n                } else {\n                    fs.unlinkSync(dir + x);\n                }\n            } catch (e) {\n                logDebug(`removeDirSync error:${e}. will try to unlink`);\n                try {\n                    fs.unlinkSync(dir + x);\n                } catch (e2) {\n                    logDebug(`removeDirSync error:${e}`);\n                }\n            }\n        });\n    }\n    if (rmSelf) {\n        // check if user want to delete the directory ir just the files in this directory\n        fs.rmdirSync(dir);\n    }\n};\n\nexport const writeFileSync = (filePath, obj, spaces = 4, addNewLine = true) => {\n    logDebug('writeFileSync', filePath);\n    if (filePath.includes('?') || filePath.includes('undefined')) return;\n    let output;\n    if (typeof obj === 'string') {\n        output = obj;\n    } else {\n        output = `${JSON.stringify(obj, null, spaces)}${\n            addNewLine ? '\\n' : ''\n        }`;\n    }\n    if (fs.existsSync(filePath)) {\n        if (fs.readFileSync(filePath).toString() === output) return;\n    }\n    logDebug('writeFileSync', filePath, 'executed', `size:${output?.length}`);\n    fsWriteFileSync(filePath, output);\n    return output;\n};\n\nexport const writeObjectSync = (filePath, obj, spaces, addNewLine = true) => {\n    logDebug('writeObjectSync', filePath);\n    logWarning('writeObjectSync is DEPRECATED. use writeFileSync instead');\n    return writeFileSync(filePath, obj, spaces, addNewLine);\n};\n\nexport const readObjectSync = (filePath, sanitize = false, c) => {\n    logDebug(`readObjectSync:${sanitize}:${filePath}`);\n    if (!filePath) {\n        logDebug('readObjectSync: filePath is undefined');\n        return null;\n    }\n    if (!fs.existsSync(filePath)) {\n        logDebug(`readObjectSync: File at ${filePath} does not exist`);\n        return null;\n    }\n    let obj;\n    try {\n        obj = JSON.parse(fs.readFileSync(filePath));\n        if (sanitize) {\n            logDebug(`readObjectSync: will sanitize file at: ${filePath}`);\n            if (c) {\n                obj = sanitizeDynamicRefs(c, obj);\n            }\n            if (obj._refs) {\n                obj = sanitizeDynamicProps(obj, obj._refs);\n            }\n        }\n    } catch (e) {\n        logError(\n            `readObjectSync: Parsing of ${chalk().white(\n                filePath\n            )} failed with ${e}`\n        );\n        return null;\n    }\n    return obj;\n};\n\nexport const updateObjectSync = (filePath, updateObj) => {\n    let output;\n    const obj = readObjectSync(filePath);\n    if (obj) {\n        output = merge(obj, updateObj);\n    } else {\n        output = updateObj;\n    }\n    writeFileSync(filePath, output);\n    return output;\n};\n\nexport const getRealPath = (c, p, key = 'undefined', original) => {\n    if (!p) {\n        if (original) {\n            logDebug(\n                `Path ${chalk().white(\n                    key\n                )} is not defined. using default: ${chalk().white(original)}`\n            );\n        }\n        return original;\n    }\n    if (p.startsWith('./')) {\n        return path.join(c.paths.project.dir, p);\n    }\n    const output = p\n        .replace(/\\$RNV_HOME/g, c.paths.rnv.dir)\n        .replace(/~/g, c.paths.home.dir)\n        .replace(/\\$USER_HOME/g, c.paths.home.dir)\n        .replace(/\\$PROJECT_HOME/g, c.paths.project.dir)\n        .replace(/\\$WORKSPACE_HOME/g, c.paths.workspace.dir)\n        .replace(/RNV_HOME/g, c.paths.rnv.dir)\n        .replace(/USER_HOME/g, c.paths.home.dir)\n        .replace(/PROJECT_HOME/g, c.paths.project.dir);\n    return output;\n};\n\nconst _refToValue = (c, ref, key) => {\n    const val = ref.replace('$REF$:', '').split('$...');\n\n    const realPath = getRealPath(c, val[0], key);\n\n    if (realPath && realPath.includes('.json') && val.length === 2) {\n        if (fs.existsSync(realPath)) {\n            const obj = readObjectSync(realPath);\n\n            try {\n                const output = val[1].split('.').reduce((o, i) => o[i], obj);\n                return output;\n            } catch (e) {\n                logWarning(`_refToValue: ${e}`);\n            }\n        } else {\n            logWarning(`_refToValue: ${chalk().white(realPath)} does not exist!`);\n        }\n    }\n    return ref;\n};\n\nexport const arrayMerge = (destinationArray, sourceArray) => {\n    const jointArray = destinationArray.concat(sourceArray);\n    const uniqueArray = jointArray.filter(\n        (item, index) => jointArray.indexOf(item) === index\n    );\n    return uniqueArray;\n};\n\nconst _arrayMergeOverride = (destinationArray, sourceArray) => sourceArray;\n\nexport const sanitizeDynamicRefs = (c, obj) => {\n    if (!obj) return obj;\n    if (Array.isArray(obj)) {\n        obj.forEach((v) => {\n            sanitizeDynamicRefs(c, v);\n        });\n    }\n    Object.keys(obj).forEach((key) => {\n        const val = obj[key];\n        if (val) {\n            if (typeof val === 'string') {\n                if (val.startsWith('$REF$:')) {\n                    obj[key] = _refToValue(c, val, key);\n                }\n            } else {\n                sanitizeDynamicRefs(c, val);\n            }\n        }\n    });\n    return obj;\n};\n\nconst fixResolve = (text) => {\n    const regEx = /{{resolvePackage\\(([\\s\\S]*?)\\)}}/g;\n    const matches = text.match(regEx);\n    let newText = text;\n    if (matches?.length) {\n        matches.forEach((match) => {\n            const val = match.replace('{{resolvePackage(', '').replace(')}}', '');\n            // TODO: Figure out WIN vs LINUX treatment here\n            // forceForwardPaths is required for WIN Android to work correctly\n            newText = newText.replace(match, doResolve(val, false, { forceForwardPaths: true }));\n        });\n    }\n    return newText;\n};\n\nexport const sanitizeDynamicProps = (obj, props = {}, configProps = {}, runtimeProps = {}) => {\n    if (!obj) {\n        return obj;\n    }\n    if (Array.isArray(obj)) {\n        obj.forEach((v, i) => {\n            let val = v;\n            if (typeof val === 'string') {\n                Object.keys(props).forEach((pk) => {\n                    const propVal = props?.[pk];\n                    val = val\n                        .replace(`@${pk}@`, propVal)\n                        .replace(`{{props.${pk}}}`, propVal);\n                    obj[i] = fixResolve(val);\n                });\n                Object.keys(configProps).forEach((pk2) => {\n                    val = val.replace(`{{configProps.${pk2}}}`, configProps[pk2]);\n                    obj[i] = fixResolve(val);\n                });\n                Object.keys(runtimeProps).forEach((pk3) => {\n                    val = val.replace(`{{runtimeProps.${pk3}}}`, runtimeProps[pk3]);\n                    obj[i] = fixResolve(val);\n                });\n            } else {\n                sanitizeDynamicProps(v, props, configProps, runtimeProps);\n            }\n        });\n    } else if (typeof obj === 'object') {\n        // console.log('KAKAK', obj?.['build.gradle']);\n        Object.keys(obj).forEach((key) => {\n            let val = obj[key];\n            // Some values are passed as keys so have to validate keys as well\n            const newKey = fixResolve(key);\n            delete obj[key];\n            obj[newKey] = val;\n            if (val) {\n                if (typeof val === 'string') {\n                    Object.keys(props).forEach((pk) => {\n                        val = val\n                            .replace(`@${pk}@`, props?.[pk])\n                            .replace(`{{props.${pk}}}`, props?.[pk]);\n                        obj[newKey] = fixResolve(val);\n                    });\n\n                    Object.keys(configProps).forEach((pk2) => {\n                        val = val.replace(`{{configProps.${pk2}}}`, configProps[pk2]);\n                        obj[newKey] = fixResolve(val);\n                    });\n\n                    Object.keys(runtimeProps).forEach((pk3) => {\n                        val = val.replace(`{{runtimeProps.${pk3}}}`, runtimeProps[pk3]);\n                        obj[newKey] = fixResolve(val);\n                    });\n                } else {\n                    sanitizeDynamicProps(val, props, configProps, runtimeProps);\n                }\n            }\n        });\n    } else if (typeof obj === 'string') {\n        return fixResolve(obj);\n    }\n\n    return obj;\n};\n\nexport const mergeObjects = (c, obj1, obj2, dynamicRefs = true, replaceArrays = false) => {\n    if (!obj2) return obj1;\n    if (!obj1) return obj2;\n    const obj = merge(obj1, obj2, {\n        arrayMerge: replaceArrays ? _arrayMergeOverride : arrayMerge\n    });\n    return dynamicRefs ? sanitizeDynamicRefs(c, obj) : obj;\n};\n\nexport const updateConfigFile = async (update, globalConfigPath) => {\n    const configContents = JSON.parse(fs.readFileSync(globalConfigPath));\n\n    if (update.androidSdk) {\n        configContents.sdks.ANDROID_SDK = update.androidSdk;\n    }\n\n    if (update.tizenSdk) {\n        configContents.sdks.TIZEN_SDK = update.tizenSdk;\n    }\n\n    if (update.webosSdk) {\n        configContents.sdks.WEBOS_SDK = update.webosSdk;\n    }\n\n    logDebug(\n        `Updating ${globalConfigPath}. New file ${JSON.stringify(\n            configContents,\n            null,\n            3\n        )}`\n    );\n\n    fsWriteFileSync(globalConfigPath, JSON.stringify(configContents, null, 3));\n};\n\nexport const replaceHomeFolder = (p) => {\n    if (isSystemWin) return p.replace('~', process.env.USERPROFILE);\n    return p.replace('~', process.env.HOME);\n};\n\nexport const getFileListSync = (dir) => {\n    let results = [];\n    const list = fs.readdirSync(dir);\n    list.forEach((file) => {\n        const fileFixed = `${dir}/${file}`;\n        const stat = fs.statSync(fileFixed);\n        if (stat && stat.isDirectory()) {\n            /* Recurse into a subdirectory */\n            results = results.concat(getFileListSync(fileFixed));\n        } else {\n            /* Is a file */\n            results.push(fileFixed);\n        }\n    });\n    return results;\n};\n\nexport default {\n    sanitizeDynamicRefs,\n    getFileListSync,\n    removeDirs,\n    copyFileSync,\n    copyFolderRecursiveSync,\n    removeDir,\n    removeDirsSync,\n    removeFilesSync,\n    saveAsJs,\n    mkdirSync,\n    copyFolderContentsRecursive,\n    copyFolderContentsRecursiveSync,\n    cleanFolder,\n    writeFileSync,\n    readObjectSync,\n    updateObjectSync,\n    arrayMerge,\n    mergeObjects,\n    updateConfigFile,\n    replaceHomeFolder\n};\n"],"file":"fileutils.js"}